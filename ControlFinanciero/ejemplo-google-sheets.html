<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ejemplo de Integración con Google Sheets API</title>
    <style>
      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        line-height: 1.6;
        color: #333;
        max-width: 1000px;
        margin: 0 auto;
        padding: 20px;
      }

      h1,
      h2 {
        color: #4caf50;
      }

      .container {
        background-color: #f9f9f9;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
      }

      button {
        background-color: #4caf50;
        color: white;
        border: none;
        padding: 10px 15px;
        border-radius: 4px;
        cursor: pointer;
        font-size: 16px;
        margin-right: 10px;
        transition: background-color 0.3s;
      }

      button:hover {
        background-color: #45a049;
      }

      button#signout-button {
        background-color: #f44336;
      }

      button#signout-button:hover {
        background-color: #d32f2f;
      }

      #error-message {
        color: #f44336;
        font-weight: bold;
        margin: 10px 0;
      }

      .data-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
      }

      .data-table th,
      .data-table td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;
      }

      .data-table th {
        background-color: #4caf50;
        color: white;
      }

      .data-table tr:nth-child(even) {
        background-color: #f2f2f2;
      }

      form {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-top: 20px;
      }

      form input,
      form select {
        padding: 8px;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-size: 16px;
      }

      form button {
        grid-column: 1 / -1;
        max-width: 200px;
        justify-self: center;
      }

      .api-status {
        display: flex;
        align-items: center;
        margin-bottom: 15px;
      }

      .status-indicator {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        margin-right: 8px;
      }

      .status-indicator.not-loaded {
        background-color: #f44336;
      }

      .status-indicator.loaded {
        background-color: #4caf50;
      }

      .status-text {
        font-size: 14px;
      }

      .instructions {
        background-color: #fff8e1;
        padding: 15px;
        border-left: 4px solid #ffc107;
        margin-bottom: 20px;
      }

      code {
        background-color: #f5f5f5;
        padding: 2px 4px;
        border-radius: 3px;
        font-family: monospace;
      }
    </style>
  </head>
  <body>
    <h1>Ejemplo de Integración con Google Sheets API</h1>

    <div class="instructions">
      <h3>Instrucciones para configurar este ejemplo:</h3>
      <ol>
        <li>
          Crea un proyecto en
          <a href="https://console.cloud.google.com" target="_blank"
            >Google Cloud Console</a
          >
        </li>
        <li>Habilita la API de Google Sheets para tu proyecto</li>
        <li>Crea credenciales (API Key y Client ID)</li>
        <li>
          Reemplaza los valores de <code>API_KEY</code> y
          <code>CLIENT_ID</code> en el archivo
          <code>ejemplo-google-sheets.js</code>
        </li>
        <li>
          Crea o usa una hoja de cálculo existente y copia su ID desde la URL
        </li>
        <li>
          Reemplaza el valor de <code>SPREADSHEET_ID</code> en el archivo
          <code>ejemplo-google-sheets.js</code>
        </li>
      </ol>
    </div>

    <div class="container">
      <h2>Estado de la API</h2>
      <div class="api-status">
        <div id="gapi-status" class="status-indicator not-loaded"></div>
        <span class="status-text">Google API Client: No cargado</span>
      </div>
      <div class="api-status">
        <div id="gis-status" class="status-indicator not-loaded"></div>
        <span class="status-text">Google Identity Services: No cargado</span>
      </div>

      <div id="error-message"></div>

      <button id="authorize-button" style="display: none">Autorizar</button>
      <button id="signout-button" style="display: none">Cerrar sesión</button>
    </div>

    <div class="container">
      <h2>Datos de la hoja de cálculo</h2>
      <div id="content" style="display: none">Cargando datos...</div>
    </div>

    <div class="container">
      <h2>Añadir nueva fila</h2>
      <form id="add-row-form">
        <input id="input-fecha" type="date" required placeholder="Fecha" />
        <select id="input-tipo" required>
          <option value="">-- Seleccionar tipo --</option>
          <option value="Ingreso">Ingreso</option>
          <option value="Gasto">Gasto</option>
        </select>
        <input id="input-categoria" required placeholder="Categoría" />
        <input
          id="input-monto"
          type="number"
          step="0.01"
          min="0"
          required
          placeholder="Monto"
        />
        <input id="input-descripcion" placeholder="Descripción (opcional)" />
        <button type="submit">Añadir fila</button>
      </form>
    </div>

    <!-- Scripts necesarios -->
    <script src="ejemplo-google-sheets.js"></script>

    <!-- Carga las bibliotecas de Google -->
    <script
      src="https://apis.google.com/js/api.js"
      onload="gapiLoaded(); document.querySelector('#gapi-status').className = 'status-indicator loaded'; document.querySelector('#gapi-status').nextElementSibling.textContent = 'Google API Client: Cargado'"
    ></script>
    <script
      src="https://accounts.google.com/gsi/client"
      onload="gisLoaded(); document.querySelector('#gis-status').className = 'status-indicator loaded'; document.querySelector('#gis-status').nextElementSibling.textContent = 'Google Identity Services: Cargado'"
    ></script>

    <script>
      // Código adicional para manejar la UI y eventos
      document.addEventListener("DOMContentLoaded", function () {
        // Asociar eventos a los botones
        const authorizeButton = document.getElementById("authorize-button");
        const signoutButton = document.getElementById("signout-button");

        if (authorizeButton) {
          authorizeButton.addEventListener("click", handleAuthClick);
        }

        if (signoutButton) {
          signoutButton.addEventListener("click", handleSignoutClick);
        }
      });
    </script>
  </body>
</html>
